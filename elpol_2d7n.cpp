/***************************************************************************
*   Copyright (C) 2005 by Fernando C�sar Meira Menandro   *
*   menandro@localhost.localdomain   *
*                                                                         *
*   This program is free software; you can redistribute it and/or modify  *
*   it under the terms of the GNU General Public License as published by  *
*   the Free Software Foundation; either version 2 of the License, or     *
*   (at your option) any later version.                                   *
*                                                                         *
*   This program is distributed in the hope that it will be useful,       *
*   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
*   GNU General Public License for more details.                          *
*                                                                         *
*   You should have received a copy of the GNU General Public License     *
*   along with this program; if not, write to the                         *
*   Free Software Foundation, Inc.,                                       *
*   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *
***************************************************************************/
#include "elpol_2d7n.h"

elpol_2D7N::elpol_2D7N()
: elpol_2d(nno, ptg)
{
}

elpol_2D7N::~elpol_2D7N()
{
}

int elpol_2D7N::qnno(){
	return nno;
}

int elpol_2D7N::qptg(){
	return ptg;
}

void elpol_2D7N::pontos_de_gauss(const int p, double *r, double *s, double *w) {
	// Pontos de Gauss para Razão Polinomial encontrados para heptagono ---
	switch (p) {
	case 50:
		r[0] = 0.4474711011960050;
		r[1] = 0.4795433392792302;
		r[2] = 0.4795433392792302;
		r[3] = 0.5152293233089896;
		r[4] = 0.5152293233089901;
		r[5] = 0.7791632971088141;
		r[6] = 0.7791632971088136;
		r[7] = 0.9216943650918753;
		r[8] = 0.9216943650918759;
		r[9] = 0.7905084697904969;
		r[10] = 0.7905084697904988;
		r[11] = 0.5858533408031454;
		r[12] = 0.5858533408031437;
		r[13] = 0.5136988959026532;
		r[14] = 0.5136988959026539;
		r[15] = 0.5254861531924346;
		r[16] = 0.5254861531924369;
		r[17] = 0.3031722436981233;
		r[18] = 0.3031722436981256;
		r[19] = 0.1207524936754554;
		r[20] = 0.1207524936754568;
		r[21] = 0.1512633590306964;
		r[22] = 0.1512633590306991;
		r[23] = 0.1951608779672018;
		r[24] = 0.1951608779672050;
		r[25] = -0.1911824198829696;
		r[26] = -0.1911824198829754;
		r[27] = -0.1544490512328547;
		r[28] = -0.1544490512328520;
		r[29] = -0.1096054506095718;
		r[30] = -0.1096054506095707;
		r[31] = -0.3034518356705341;
		r[32] = -0.3034518356705318;
		r[33] = -0.5253069297789876;
		r[34] = -0.5253069297789925;
		r[35] = -0.5104208444932259;
		r[36] = -0.5104208444932239;
		r[37] = -0.5828975711914933;
		r[38] = -0.5828975711914918;
		r[39] = -0.7887942715561657;
		r[40] = -0.7887942715561689;
		r[41] = -0.9224981447747754;
		r[42] = -0.9224981447747764;
		r[43] = -0.7819946837327481;
		r[44] = -0.7819946837327493;
		r[45] = -0.5176349278367759;
		r[46] = -0.5176349278367753;
		r[47] = -0.4806259878575722;
		r[48] = -0.4806259878575726;
		r[49] = -0.4538765879444000;
		s[0] = 0.0000000000000000;
		s[1] = 0.0600013717407285;
		s[2] = -0.0600013717407291;
		s[3] = 0.1331707687641790;
		s[4] = -0.1331707687641771;
		s[5] = 0.1813101888480304;
		s[6] = -0.1813101888480320;
		s[7] = 0.1584843211309657;
		s[8] = -0.1584843211309626;
		s[9] = 0.4885146763985153;
		s[10] = -0.4885146763985123;
		s[11] = 0.4665199115531280;
		s[12] = -0.4665199115531302;
		s[13] = 0.5415676586330265;
		s[14] = -0.5415676586330258;
		s[15] = 0.7466156517870255;
		s[16] = -0.7466156517870239;
		s[17] = 0.6259072381876683;
		s[18] = -0.6259072381876671;
		s[19] = 0.3540268107464684;
		s[20] = -0.3540268107464680;
		s[21] = 0.8017195113593583;
		s[22] = -0.8017195113593577;
		s[23] = 0.9190098821190970;
		s[24] = -0.9190098821190962;
		s[25] = 0.9138492693213407;
		s[26] = -0.9138492693213395;
		s[27] = 0.7834172462309044;
		s[28] = -0.7834172462309048;
		s[29] = 0.3179978019139254;
		s[30] = -0.3179978019139257;
		s[31] = 0.6245269577349453;
		s[32] = -0.6245269577349464;
		s[33] = 0.7465798644698005;
		s[34] = -0.7465798644697972;
		s[35] = 0.5388839133961642;
		s[36] = -0.5388839133961660;
		s[37] = 0.4640982605006151;
		s[38] = -0.4640982605006170;
		s[39] = 0.4884094606474799;
		s[40] = -0.4884094606474749;
		s[41] = 0.1597733736177755;
		s[42] = -0.1597733736177695;
		s[43] = 0.1782541410763139;
		s[44] = -0.1782541410763088;
		s[45] = 0.1334192553990174;
		s[46] = -0.1334192553990193;
		s[47] = 0.0602593902951062;
		s[48] = -0.0602593902951031;
		s[49] = 0.0000000019831835;
		w[0] = 0.1976826831435333;
		w[1] = 0.0359548513742560;
		w[2] = 0.0359548513742560;
		w[3] = -0.0127660672145593;
		w[4] = -0.0127660672145593;
		w[5] = 0.0744830901460255;
		w[6] = 0.0744830901460255;
		w[7] = 0.0143115178402077;
		w[8] = 0.0143115178402077;
		w[9] = 0.0202944247492704;
		w[10] = 0.0202944247492704;
		w[11] = 0.1022989317402975;
		w[12] = 0.1022989317402975;
		w[13] = -0.0049415738191838;
		w[14] = -0.0049415738191838;
		w[15] = 0.0314506792367063;
		w[16] = 0.0314506792367063;
		w[17] = 0.0923864090780703;
		w[18] = 0.0923864090780703;
		w[19] = 0.1505709289363290;
		w[20] = 0.1505709289363290;
		w[21] = 0.0567401201969391;
		w[22] = 0.0567401201969391;
		w[23] = 0.0145407761987486;
		w[24] = 0.0145407761987486;
		w[25] = 0.0178072001474560;
		w[26] = 0.0178072001474560;
		w[27] = 0.0581734940847780;
		w[28] = 0.0581734940847780;
		w[29] = 0.1712859365121670;
		w[30] = 0.1712859365121670;
		w[31] = 0.0912302551576553;
		w[32] = 0.0912302551576553;
		w[33] = 0.0315951129310550;
		w[34] = 0.0315951129310550;
		w[35] = -0.0072683811364093;
		w[36] = -0.0072683811364093;
		w[37] = 0.1063911891246310;
		w[38] = 0.1063911891246310;
		w[39] = 0.0210430471672937;
		w[40] = 0.0210430471672937;
		w[41] = 0.0139269097294280;
		w[42] = 0.0139269097294280;
		w[43] = 0.0728594117913550;
		w[44] = 0.0728594117913550;
		w[45] = -0.0069429564202803;
		w[46] = -0.0069429564202803;
		w[47] = 0.0346759907072691;
		w[48] = 0.0346759907072691;
		w[49] = 0.1783155244435233;
		break;
	}

	// Pontos de Gauss-Legendre encontrados para heptagono
	//switch (p) {
	//case 4: // polinomio ordem 3
	//	r[0] = 0.6255681659215563;
	//	r[1] = -0.2142726536339368;
	//	r[2] = -0.6255681659215564;
	//	r[3] = 0.2142726536339366;
	//	s[0] = 0.2142726536339368;
	//	s[1] = 0.6255681659215563;
	//	s[2] = -0.2142726536339366;
	//	s[3] = -0.6255681659215564;
	//	w[0] = 0.6841025471595260;
	//	w[1] = 0.6841025471595260;
	//	w[2] = 0.6841025471595260;
	//	w[3] = 0.6841025471595260;
	//	break;
	//case 7: // polinomio ordem 5
	//	r[0] = 0.7238297563337083;
	//	r[1] = 0.1472003572006518;
	//	r[2] = -0.5766293991330564;
	//	r[3] = -0.7238297563337083;
	//	r[4] = -0.1472003572006517;
	//	r[5] = 0.5766293991330563;
	//	r[6] = 0.0000000000000005;
	//	s[0] = 0.2479309729575171;
	//	s[1] = 0.7508204434788500;
	//	s[2] = 0.5028894705213332;
	//	s[3] = -0.2479309729575170;
	//	s[4] = -0.7508204434788500;
	//	s[5] = -0.5028894705213333;
	//	s[6] = 0.0000000000000001;
	//	w[0] = 0.3406480379132526;
	//	w[1] = 0.3406480379132526;
	//	w[2] = 0.3406480379132526;
	//	w[3] = 0.3406480379132526;
	//	w[4] = 0.3406480379132526;
	//	w[5] = 0.3406480379132526;
	//	w[6] = 0.6925219611585892;
	//	break;
	//case 12: // ordem 6
	//	r[0] = 0.7550883171546398;
	//	r[1] = 0.7550883171546398;
	//	r[2] = -0.2844488581117283;
	//	r[3] = -0.2844488581117284;
	//	r[4] = 0.2040621227397856;
	//	r[5] = 0.2040621227397856;
	//	r[6] = -0.4863824510611606;
	//	r[7] = -0.4863824510611607;
	//	r[8] = 0.3249553545947211;
	//	r[9] = 0.3249553545947211;
	//	r[10] = -0.7831464025536120;
	//	r[11] = -0.7831464025536120;
	//	s[0] = 0.3502156009873018;
	//	s[1] = -0.3502156009873018;
	//	s[2] = -0.3613289378592468;
	//	s[3] = 0.3613289378592468;
	//	s[4] = 0.7700974136403042;
	//	s[5] = -0.7700974136403042;
	//	s[6] = 0.7594372638940036;
	//	s[7] = -0.7594372638940035;
	//	s[8] = -0.1992573449936139;
	//	s[9] = 0.1992573449936139;
	//	s[10] = -0.2151796559597539;
	//	s[11] = 0.2151796559597541;
	//	w[0] = 0.1918152377757648;
	//	w[1] = 0.1918152377757648;
	//	w[2] = 0.3986321414231203;
	//	w[3] = 0.3986321414231203;
	//	w[4] = 0.2415780891677459;
	//	w[5] = 0.2415780891677459;
	//	w[6] = 0.1079968509617617;
	//	w[7] = 0.1079968509617617;
	//	w[8] = 0.2771529289801894;
	//	w[9] = 0.2771529289801894;
	//	w[10] = 0.1510298460104701;
	//	w[11] = 0.1510298460104701;
	//	break;
	//case 16:
	//	r[0] = 0.1276168301307205;
	//	r[1] = 0.1276168301307205;
	//	r[2] = -0.4053425121477094;
	//	r[3] = -0.4053425121477094;
	//	r[4] = -0.7879519226464595;
	//	r[5] = -0.7879519226464596;
	//	r[6] = 0.0828186085296878;
	//	r[7] = 0.0828186085296876;
	//	r[8] = 0.6127070734564268;
	//	r[9] = 0.6127070734564268;
	//	r[10] = -0.3755322104713331;
	//	r[11] = -0.3755322104713333;
	//	r[12] = 0.1539942952564272;
	//	r[13] = 0.1539942952564274;
	//	r[14] = 0.5418216463061164;
	//	r[15] = 0.8866988426177320;
	//	s[0] = -0.1490668093012800;
	//	s[1] = 0.1490668093012800;
	//	s[2] = 0.2259281525316539;
	//	s[3] = -0.2259281525316538;
	//	s[4] = 0.3095516214853822;
	//	s[5] = -0.3095516214853821;
	//	s[6] = 0.5100806420522777;
	//	s[7] = -0.5100806420522777;
	//	s[8] = 0.5510981065938946;
	//	s[9] = -0.5510981065938946;
	//	s[10] = 0.7417535573906761;
	//	s[11] = -0.7417535573906759;
	//	s[12] = 0.8687581555362361;
	//	s[13] = -0.8687581555362361;
	//	s[14] = 0.0000000000102235;
	//	s[15] = -0.0000000000040105;
	//	w[0] = 0.1185983078311412;
	//	w[1] = 0.1185983078311412;
	//	w[2] = 0.2453764631968670;
	//	w[3] = 0.2453764631968670;
	//	w[4] = 0.1447750410527415;
	//	w[5] = 0.1447750410527415;
	//	w[6] = 0.2670118477615240;
	//	w[7] = 0.2670118477615240;
	//	w[8] = 0.1681763071628871;
	//	w[9] = 0.1681763071628871;
	//	w[10] = 0.1524140290242357;
	//	w[11] = 0.1524140290242357;
	//	w[12] = 0.0870315191010727;
	//	w[13] = 0.0870315191010727;
	//	w[14] = 0.2713662505935009;
	//	w[15] = 0.0982769077090027;
	//	break;
	//}
}

void elpol_2D7N::funcao_Forma(double r, double s, double *N, double *dn){
	// RENAN
	// CALCULO DAS FUNCOES DE FORMA (N) E SUAS DERIVADAS (dn)
	double b, b2, dbdr, dbds, A, B, C, D, E, F, G;
	// Expressoes que se repetem	
	A = (0.9009688679024191 + 1.*r);
	B = (-4.048917339522304 + 1.*r - 4.381286267534823*s);
	C = (1.445041867912629 + 1.*r - 1.253960337662704*s);
	D = (-1. + 1.*r - 0.4815746188075287*s);
	E = (1.445041867912629 + 1.*r + 1.253960337662704*s);
	F = (-1. + 1.*r + 0.4815746188075287*s);
	G = (-4.048917339522304 + 1.*r + 4.381286267534823*s);
	b = (1412.7983817039994 + 41.27066882957638*pow(r, 4) + pow(s, 2)*(-762.7594506989002 + 41.27066882957639*pow(s, 2)) + 
		pow(r, 2)*(-762.7594506988999 + 82.54133765915262*pow(s, 2)));
	b2 = pow(b, 2);
	dbdr = (165.08267531830552*pow(r, 3) + 2 * r*(-762.7594506988999 + 82.54133765915262*pow(s, 2)));
	dbds = (165.08267531830523*pow(r, 2)*s + 82.54133765915277*pow(s, 3) + 2 * s*(-762.7594506989002 + 41.27066882957639*pow(s, 2)));
	// Funcoes de Forma
	N[0] = (26.495528883381816*A*B*C*D*E) / b;
	N[1] = (-38.28714854897507*A*B*D*F*E) / b;
	N[2] = (8.519692053642082*B*D*F*E*G) / b;
	N[3] = (8.519692053642082*B*C*D*F*G) / b;
	N[4] = (-38.28714854897507*A*C*D*F*G) / b;
	N[5] = (26.495528883381816*A*C*F*E*G) / b;
	N[6] = (6.543855223902344*A*B*C*E*G) / b;
	// Derivadas em relacao a r 
	dn[0] = (-26.495528883381816*A*B*C*D*E*dbdr) / b2 + (26.495528883381816*A*B*C*D) / b + (26.495528883381816*A*B*C*E) / b + (26.495528883381816*A*B*D*E) / b + (26.495528883381816*A*C*D*E) / b + (26.495528883381816*B*C*D*E) / b;
	dn[2] = (38.28714854897507*A*B*D*F*E*dbdr) / b2 - (38.28714854897507*A*B*D*F) / b - (38.28714854897507*A*B*D*E) / b - (38.28714854897507*A*B*F*E) / b - (38.28714854897507*A*D*F*E) / b - (38.28714854897507*B*D*F*E) / b;
	dn[4] = (-8.519692053642082*B*D*F*E*G*dbdr) / b2 + (8.519692053642082*B*D*F*E) / b + (8.519692053642082*B*D*F*G) / b + (8.519692053642082*B*D*E*G) / b + (8.519692053642082*B*F*E*G) / b + (8.519692053642082*D*F*E*G) / b;
	dn[6] = (-8.519692053642082*B*C*D*F*G*dbdr) / b2 + (8.519692053642082*B*C*D*F) / b + (8.519692053642082*B*C*D*G) / b + (8.519692053642082*B*C*F*G) / b + (8.519692053642082*B*D*F*G) / b + (8.519692053642082*C*D*F*G) / b;
	dn[8] = (38.28714854897507*A*C*D*F*G*dbdr) / b2 - (38.28714854897507*A*C*D*F) / b - (38.28714854897507*A*C*D*G) / b - (38.28714854897507*A*C*F*G) / b - (38.28714854897507*A*D*F*G) / b - (38.28714854897507*C*D*F*G) / b;
	dn[10] = (-26.495528883381816*A*C*F*E*G*dbdr) / b2 + (26.495528883381816*A*C*F*E) / b + (26.495528883381816*A*C*F*G) / b + (26.495528883381816*A*C*E*G) / b + (26.495528883381816*A*F*E*G) / b + (26.495528883381816*C*F*E*G) / b;
	dn[12] = (-6.543855223902344*A*B*C*E*G*dbdr) / b2 + (6.543855223902344*A*B*C*E) / b + (6.543855223902344*A*B*C*G) / b + (6.543855223902344*A*B*E*G) / b + (6.543855223902344*A*C*E*G) / b + (6.543855223902344*B*C*E*G) / b;
	// Derivadas em relacao a s
	dn[1] = (-26.495528883381816*A*B* C*D*E* dbds) / b2 + (33.22434234515739*A*B* C*D) / b - (12.759574222118465*A*B* C*E) / b - (33.22434234515739*A*B*D* E) / b - (116.08449684783301*A*C*D* E) / b;
	dn[3] = (38.28714854897507*A*B*D* F*E* dbds) / b2 - (48.010565722614885*A*B*D* F) / b - (18.438118967699896*A*B*D* E) / b + (18.438118967699896*A*B*F* E) / b + (167.7469581606903*A*D*F* E) / b;
	dn[5] = (-8.519692053642082*B*D*F* E*G* dbds) / b2 + (37.32720979824761*B*D*F* E) / b + (10.68335592436728*B*D*F* G) / b + (4.102867453090217*B*D* E*G) / b - (4.102867453090217*B*F* E*G) / b - (37.32720979824761*D*F*E* G) / b;
	dn[7] = (-8.519692053642082*B*C* D*F*G* dbds) / b2 + (37.32720979824761*B*C* D*F) / b + (4.102867453090217*B*C* D*G) / b - (4.102867453090217*B*C* F*G) / b - (10.68335592436728*B*D*F* G) / b - (37.32720979824761*C*D*F* G) / b;
	dn[9] = (38.28714854897507*A*C*D* F*G* dbds) / b2 - (167.7469581606903*A*C*D* F) / b - (18.438118967699896*A*C*D* G) / b + (18.438118967699896*A*C*F* G) / b + (48.010565722614885*A*D*F* G) / b;
	dn[11] = (-26.495528883381816*A*C*F* E*G* dbds) / b2 + (116.08449684783301*A*C*F* E) / b + (33.22434234515739*A*C*F* G) / b + (12.759574222118465*A*C* E*G) / b - (33.22434234515739*A*F*E* G) / b;
	dn[13] = (-6.543855223902344*A*B* C*E* G*dbds) / b2 + (28.670503029219354*A*B* C*E) / b + (8.205734906180433*A*B* C*G) / b - (8.205734906180433*A*B* E*G) / b - (28.670503029219354*A*C* E*G) / b;
}